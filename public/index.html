<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Echo</title>
<style>
  body { font: 16px/1.5 system-ui, sans-serif; margin: 2rem; max-width: 760px }
  .card { padding: 1rem; border: 1px solid #ddd; border-radius: 12px; margin: 1rem 0 }
  textarea,input,button { width: 100%; padding: .75rem; margin: .25rem 0 }
  pre { background:#f7f7f7; padding:.75rem; border-radius:8px; overflow:auto }
</style>
<h1>Echo — Local</h1>

<div class="card">
  <button id="btnHealth">Check /health</button>
  <pre id="outHealth">—</pre>
</div>

<div class="card">
  <textarea id="msg" rows="4" placeholder="Type something…"></textarea>
  <button id="btnReflect">POST /reflect</button>
  <pre id="outReflect">—</pre>
</div>

<script>
const configuredBackend = (window.BACKEND_URL || '').replace(/\/$/, '');
const withBackend = path => `${configuredBackend}${path}`;
const outHealth=document.getElementById('outHealth');
const outReflect=document.getElementById('outReflect');

btnHealth.onclick = async () => {
  outHealth.textContent='checking…';
  try { const r=await fetch(withBackend('/health')); outHealth.textContent=await r.text(); }
  catch(e){ outHealth.textContent=String(e); }
};

btnReflect.onclick = async () => {
  const body = { message: document.getElementById('msg').value || 'hello from Echo' };
  outReflect.textContent='sending…';
  try{
    const r=await fetch(withBackend('/reflect'),{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify(body)});
    outReflect.textContent = JSON.stringify(await r.json(), null, 2);
  }catch(e){ outReflect.textContent=String(e); }
};
</script>
